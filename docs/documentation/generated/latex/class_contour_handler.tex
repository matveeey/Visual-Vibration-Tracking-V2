\hypertarget{class_contour_handler}{}\doxysection{Класс Contour\+Handler}
\label{class_contour_handler}\index{ContourHandler@{ContourHandler}}


Класс для создания объектов-\/обработчиков контуров.  




{\ttfamily \#include $<$contour\+\_\+handler.\+h$>$}

\doxysubsection*{Открытые члены}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_contour_handler_a166e4049c623a262f39ff0adbc19becc}{Contour\+Handler}} (Mat frame, Rect $\ast$ROI=nullptr)
\begin{DoxyCompactList}\small\item\em Конструктор этого класса \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_contour_handler_a8c2833a1ef8248481212716d2b9427e3}{Draw\+Contours}} (Mat \&frame)
\begin{DoxyCompactList}\small\item\em Отрисовывает контура на изображении \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ Point2i $>$ $>$ \mbox{\hyperlink{class_contour_handler_a5479d4bdebb1fff89f7d5467fc60b0c6}{Get\+Contours}} ()
\begin{DoxyCompactList}\small\item\em Возвращает найденные контура в виде \{ \{ contour\+\_\+1 \}, \{ contour\+\_\+2 \}, ... , \{ contour\+\_\+n \} \}. \end{DoxyCompactList}\item 
std\+::vector$<$ Point2f $>$ \mbox{\hyperlink{class_contour_handler_a9cac49d5d2fda43b7be55efbc06913f6}{Get\+Continous\+Contours}} ()
\begin{DoxyCompactList}\small\item\em Возвращает найденные контура в виде \{ contour\+\_\+1, contour\+\_\+2, ... , contour\+\_\+n \}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Закрытые члены}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\std\+::vector$<$ T $>$ \mbox{\hyperlink{class_contour_handler_abc7f823a49e23e395f25c3d9778da80f}{Make\+Twice\+Thinner}} (std\+::vector$<$ T $>$ src)
\begin{DoxyCompactList}\small\item\em Удаляет каждый второй элемент вектора (уменьшает размер в два раза) \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\float \mbox{\hyperlink{class_contour_handler_aaa6ec340cf86e6296174df57f87fd1ab}{Calculate\+Distance}} (T point1, T point2)
\begin{DoxyCompactList}\small\item\em Вычисляет расстояние между двумя точками \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Закрытые данные}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ std\+::vector$<$ Point $>$ $>$ \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\+\_\+shapes\+\_\+}}
\begin{DoxyCompactList}\small\item\em Контуры в виде \{ \{ contour\+\_\+1 \}, \{ contour\+\_\+2 \}, ... , \{ contour\+\_\+n \} \}. \end{DoxyCompactList}\item 
float \mbox{\hyperlink{class_contour_handler_a1558e96a61f972bfc202cededb335311}{minimal\+\_\+distance\+\_\+}}
\begin{DoxyCompactList}\small\item\em Минимальное расстояние между точками контура, при котором \char`\"{}левая\char`\"{} (\char`\"{}первая\char`\"{}) точка будет сохранена \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Подробное описание}
Класс для создания объектов-\/обработчиков контуров. 

Способен найти контура на входном изображении (принимается в конструкторе), отрисовать их, и произвести определенные операции над ними (например, уменьшить размер или плотность точек в контуре 

См. определение в файле \mbox{\hyperlink{contour__handler_8h_source}{contour\+\_\+handler.\+h}} строка \mbox{\hyperlink{contour__handler_8h_source_l00022}{22}}



\doxysubsection{Конструктор(ы)}
\mbox{\Hypertarget{class_contour_handler_a166e4049c623a262f39ff0adbc19becc}\label{class_contour_handler_a166e4049c623a262f39ff0adbc19becc}} 
\index{ContourHandler@{ContourHandler}!ContourHandler@{ContourHandler}}
\index{ContourHandler@{ContourHandler}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{ContourHandler()}{ContourHandler()}}
{\footnotesize\ttfamily Contour\+Handler\+::\+Contour\+Handler (\begin{DoxyParamCaption}\item[{Mat}]{frame,  }\item[{Rect $\ast$}]{ROI = {\ttfamily nullptr} }\end{DoxyParamCaption})}



Конструктор этого класса 


\begin{DoxyParams}{Аргументы}
{\em frame} & Mat-\/instance изображения, на котором будет выполнен поиск контуров. Изображение может быть в RGB/gray-\/scale (в первом случае будет сконвертировано внутри) \\
\hline
{\em ROI} & регион интереса, на котором будут найдены контуры. \\
\hline
\end{DoxyParams}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00003}{3}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00003                                                    :}
\DoxyCodeLine{00004     \mbox{\hyperlink{class_contour_handler_a1558e96a61f972bfc202cededb335311}{minimal\_distance\_}}\{ 5.0f \}}
\DoxyCodeLine{00005 \{}
\DoxyCodeLine{00006     Mat prep\_frame;}
\DoxyCodeLine{00007     std::vector<Vec4i> hierarchy = \{ 0 \};}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009     \textcolor{comment}{// Проверка на то, был ли послан ROI или нет}}
\DoxyCodeLine{00010     \textcolor{keywordflow}{if} (ROI != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00011         prep\_frame = Mat(frame, *ROI);}
\DoxyCodeLine{00012     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00013         frame.copyTo(prep\_frame);}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015     \textcolor{comment}{// Проверка на грейскейл}}
\DoxyCodeLine{00016     \textcolor{keywordflow}{if} (frame.channels() > 2)}
\DoxyCodeLine{00017         cvtColor(prep\_frame, prep\_frame, COLOR\_BGR2GRAY);}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019     \textcolor{comment}{// Имаге процессинг}}
\DoxyCodeLine{00020     GaussianBlur(prep\_frame, prep\_frame, Size(7, 7), 0);}
\DoxyCodeLine{00021     threshold(prep\_frame, prep\_frame, 80, 255, cv::THRESH\_BINARY);}
\DoxyCodeLine{00022     Canny(prep\_frame, prep\_frame, 64, 192);}
\DoxyCodeLine{00023     Canny(prep\_frame, prep\_frame, 64, 192);}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025     \textcolor{comment}{// Находим контуры и дополнительно, если ROI не пустой}}
\DoxyCodeLine{00026     \textcolor{comment}{// транслируем координаты из координат "{}ROI-\/куска"{} в координаты исходного изображения (аналог contour\_shapes\_[i][j] += ROI.tl())}}
\DoxyCodeLine{00027     \textcolor{keywordflow}{if} (ROI != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00028         findContours(prep\_frame, \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}, hierarchy, RETR\_EXTERNAL, CHAIN\_APPROX\_SIMPLE, ROI-\/>tl());}
\DoxyCodeLine{00029     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00030         findContours(prep\_frame, \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}, hierarchy, RETR\_EXTERNAL, CHAIN\_APPROX\_SIMPLE);}
\DoxyCodeLine{00031 \}}

\end{DoxyCode}


\doxysubsection{Методы}
\mbox{\Hypertarget{class_contour_handler_aaa6ec340cf86e6296174df57f87fd1ab}\label{class_contour_handler_aaa6ec340cf86e6296174df57f87fd1ab}} 
\index{ContourHandler@{ContourHandler}!CalculateDistance@{CalculateDistance}}
\index{CalculateDistance@{CalculateDistance}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{CalculateDistance()}{CalculateDistance()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
float Contour\+Handler\+::\+Calculate\+Distance (\begin{DoxyParamCaption}\item[{T}]{point1,  }\item[{T}]{point2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Вычисляет расстояние между двумя точками 


\begin{DoxyParams}{Аргументы}
{\em point1} & первая точка \\
\hline
{\em point2} & вторая точка \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Возвращает}
Расстояние между точками 
\end{DoxyReturn}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00094}{94}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00095 \{}
\DoxyCodeLine{00096     \textcolor{keywordflow}{return} sqrt((point1.x -\/ point2.x) * (point1.x -\/ point2.x) + (point1.y -\/ point2.y) * (point1.y -\/ point2.y));}
\DoxyCodeLine{00097 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_contour_handler_a8c2833a1ef8248481212716d2b9427e3}\label{class_contour_handler_a8c2833a1ef8248481212716d2b9427e3}} 
\index{ContourHandler@{ContourHandler}!DrawContours@{DrawContours}}
\index{DrawContours@{DrawContours}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{DrawContours()}{DrawContours()}}
{\footnotesize\ttfamily void Contour\+Handler\+::\+Draw\+Contours (\begin{DoxyParamCaption}\item[{Mat \&}]{frame }\end{DoxyParamCaption})}



Отрисовывает контура на изображении 


\begin{DoxyParams}{Аргументы}
{\em frame} & адрес изображения, на котором будет отрисованы найденные контура \\
\hline
\end{DoxyParams}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00033}{33}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00034 \{}
\DoxyCodeLine{00035     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}.size(); i++)}
\DoxyCodeLine{00036     \{}
\DoxyCodeLine{00037         drawContours(frame, \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}, i, Scalar(255, 0, 0), 6);}
\DoxyCodeLine{00038     \}}
\DoxyCodeLine{00039 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_contour_handler_a9cac49d5d2fda43b7be55efbc06913f6}\label{class_contour_handler_a9cac49d5d2fda43b7be55efbc06913f6}} 
\index{ContourHandler@{ContourHandler}!GetContinousContours@{GetContinousContours}}
\index{GetContinousContours@{GetContinousContours}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{GetContinousContours()}{GetContinousContours()}}
{\footnotesize\ttfamily std\+::vector$<$ Point2f $>$ Contour\+Handler\+::\+Get\+Continous\+Contours (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Возвращает найденные контура в виде \{ contour\+\_\+1, contour\+\_\+2, ... , contour\+\_\+n \}. 

Фактически выполняет \char`\"{}склеивание\char`\"{} найденных контуров в один вектор \begin{DoxyReturn}{Возвращает}
Изображение с нарисованными контурами 
\end{DoxyReturn}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00046}{46}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00047 \{}
\DoxyCodeLine{00048     std::vector<Point2f> continous\_contour\_shapes;}
\DoxyCodeLine{00049 }
\DoxyCodeLine{00050     \textcolor{comment}{// Проходимся по вектору контуров (std::vector<std::vector>>) и проверяем на соответствие условию ниже}}
\DoxyCodeLine{00051     \textcolor{keyword}{auto} extern\_itt = \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}.begin();}
\DoxyCodeLine{00052     \textcolor{keywordflow}{while} (extern\_itt != \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}}.end())}
\DoxyCodeLine{00053     \{}
\DoxyCodeLine{00054         std::vector<Point> shape = *extern\_itt;}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056         \textcolor{keyword}{auto} intern\_itt = shape.begin();}
\DoxyCodeLine{00057         \textcolor{keywordflow}{while} (intern\_itt != shape.end())}
\DoxyCodeLine{00058         \{}
\DoxyCodeLine{00059             \textcolor{comment}{// То самое условие: минимальная дистанция между точками + размер контура}}
\DoxyCodeLine{00060             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_contour_handler_aaa6ec340cf86e6296174df57f87fd1ab}{CalculateDistance}}(*intern\_itt, *(intern\_itt + 1)) > \mbox{\hyperlink{class_contour_handler_a1558e96a61f972bfc202cededb335311}{minimal\_distance\_}} \&\& (contourArea(*extern\_itt) > 100))}
\DoxyCodeLine{00061             \{}
\DoxyCodeLine{00062                 continous\_contour\_shapes.push\_back(*intern\_itt);}
\DoxyCodeLine{00063             \}}
\DoxyCodeLine{00064             intern\_itt++;}
\DoxyCodeLine{00065         \}}
\DoxyCodeLine{00066 }
\DoxyCodeLine{00067         extern\_itt++;}
\DoxyCodeLine{00068     \}}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070     \textcolor{comment}{// Ограничиваем длину контуров}}
\DoxyCodeLine{00071     \textcolor{keywordflow}{while} (continous\_contour\_shapes.size() > 500)}
\DoxyCodeLine{00072         continous\_contour\_shapes = \mbox{\hyperlink{class_contour_handler_abc7f823a49e23e395f25c3d9778da80f}{MakeTwiceThinner}}(continous\_contour\_shapes);}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074     \textcolor{keywordflow}{return} continous\_contour\_shapes;}
\DoxyCodeLine{00075 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_contour_handler_a5479d4bdebb1fff89f7d5467fc60b0c6}\label{class_contour_handler_a5479d4bdebb1fff89f7d5467fc60b0c6}} 
\index{ContourHandler@{ContourHandler}!GetContours@{GetContours}}
\index{GetContours@{GetContours}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{GetContours()}{GetContours()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$ Point2i $>$ $>$ Contour\+Handler\+::\+Get\+Contours (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Возвращает найденные контура в виде \{ \{ contour\+\_\+1 \}, \{ contour\+\_\+2 \}, ... , \{ contour\+\_\+n \} \}. 

\begin{DoxyReturn}{Возвращает}
Контуры 
\end{DoxyReturn}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00041}{41}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00042 \{}
\DoxyCodeLine{00043     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}{contour\_shapes\_}};}
\DoxyCodeLine{00044 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_contour_handler_abc7f823a49e23e395f25c3d9778da80f}\label{class_contour_handler_abc7f823a49e23e395f25c3d9778da80f}} 
\index{ContourHandler@{ContourHandler}!MakeTwiceThinner@{MakeTwiceThinner}}
\index{MakeTwiceThinner@{MakeTwiceThinner}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{MakeTwiceThinner()}{MakeTwiceThinner()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::vector$<$ T $>$ Contour\+Handler\+::\+Make\+Twice\+Thinner (\begin{DoxyParamCaption}\item[{std\+::vector$<$ T $>$}]{src }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Удаляет каждый второй элемент вектора (уменьшает размер в два раза) 


\begin{DoxyParams}{Аргументы}
{\em src} & вектор, который будет \char`\"{}проряжён\char`\"{} \\
\hline
\end{DoxyParams}


См. определение в файле \mbox{\hyperlink{contour__handler_8cpp_source}{contour\+\_\+handler.\+cpp}} строка \mbox{\hyperlink{contour__handler_8cpp_source_l00078}{78}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00079 \{}
\DoxyCodeLine{00080     std::vector<T> dst;}
\DoxyCodeLine{00081 }
\DoxyCodeLine{00082     \textcolor{keyword}{auto} it = src.begin();}
\DoxyCodeLine{00083     \textcolor{keywordflow}{while} (it != src.end() -\/ 1)}
\DoxyCodeLine{00084     \{}
\DoxyCodeLine{00085         \textcolor{keywordflow}{if} ((std::distance(src.begin(), it)) \% 2 == 0)}
\DoxyCodeLine{00086             dst.push\_back(*(it));}
\DoxyCodeLine{00087         it++;}
\DoxyCodeLine{00088     \}}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090     \textcolor{keywordflow}{return} dst;}
\DoxyCodeLine{00091 \}}

\end{DoxyCode}


\doxysubsection{Данные класса}
\mbox{\Hypertarget{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}\label{class_contour_handler_acc71ce959c1863dfd3a995ea28e4225c}} 
\index{ContourHandler@{ContourHandler}!contour\_shapes\_@{contour\_shapes\_}}
\index{contour\_shapes\_@{contour\_shapes\_}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{contour\_shapes\_}{contour\_shapes\_}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$Point$>$ $>$ Contour\+Handler\+::contour\+\_\+shapes\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Контуры в виде \{ \{ contour\+\_\+1 \}, \{ contour\+\_\+2 \}, ... , \{ contour\+\_\+n \} \}. 



См. определение в файле \mbox{\hyperlink{contour__handler_8h_source}{contour\+\_\+handler.\+h}} строка \mbox{\hyperlink{contour__handler_8h_source_l00069}{69}}

\mbox{\Hypertarget{class_contour_handler_a1558e96a61f972bfc202cededb335311}\label{class_contour_handler_a1558e96a61f972bfc202cededb335311}} 
\index{ContourHandler@{ContourHandler}!minimal\_distance\_@{minimal\_distance\_}}
\index{minimal\_distance\_@{minimal\_distance\_}!ContourHandler@{ContourHandler}}
\doxysubsubsection{\texorpdfstring{minimal\_distance\_}{minimal\_distance\_}}
{\footnotesize\ttfamily float Contour\+Handler\+::minimal\+\_\+distance\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Минимальное расстояние между точками контура, при котором \char`\"{}левая\char`\"{} (\char`\"{}первая\char`\"{}) точка будет сохранена 

\begin{DoxySeeAlso}{См. также}
Используется в \mbox{\hyperlink{class_contour_handler_a9cac49d5d2fda43b7be55efbc06913f6}{Get\+Continous\+Contours()}} 
\end{DoxySeeAlso}


См. определение в файле \mbox{\hyperlink{contour__handler_8h_source}{contour\+\_\+handler.\+h}} строка \mbox{\hyperlink{contour__handler_8h_source_l00074}{74}}



Объявления и описания членов классов находятся в файлах\+:\begin{DoxyCompactItemize}
\item 
C\+:/\+Users/seeyo/source/repos/\+Visual-\/\+Vibration-\/\+Tracking-\/\+V2/include/\+VVT-\/\+V2/contour\+\_\+handler.\+h\item 
C\+:/\+Users/seeyo/source/repos/\+Visual-\/\+Vibration-\/\+Tracking-\/\+V2/source/contour\+\_\+handler.\+cpp\end{DoxyCompactItemize}
